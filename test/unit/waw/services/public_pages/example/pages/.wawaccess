wawaccess do
  
  # We don't inherits static configuration
  inherits false
  
  # By default, we deny the call
  strategy :deny_all
  
  # When a folder is requested, find the associated index file
  match directory do |url, realpath, wawaccess, env|
    wawaccess.apply "#{url}/index.wtpl", env
  end

  # We serve .wtpl files using wlang
  match '.wtpl' do |url, realpath, wawaccess, env|
    context = {"who" => "blambeau"}
    contents = WLang.file_instantiate(realpath, context)
    [200, {'Content-Type' => 'text/html'}, [contents]]
  end
  
end